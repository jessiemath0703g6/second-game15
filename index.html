<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jessie Math - è§’æŸ±èˆ‡åœ“æŸ±</title>

    <!-- âœ… å¿«å–é€£çµé è¦½ï¼ˆè«‹æ”¾åœ¨ <head> è£¡ï¼‰ -->
    <meta name="description" content="Â© 2025â€“2026 Jessie Math æ·æè€å¸«. All rights reserved.">
    <!-- âœ… LINE / FB é è¦½ç”¨ -->
    <meta property="og:title" content="Jessie Math  - è§’æŸ±èˆ‡åœ“æŸ±">
    <meta property="og:description" content="Â© 2025â€“2026 Jessie Math æ·æè€å¸«. All rights reserved.">
    <meta property="og:type" content="website">

    <!-- âœ… é è¦½åœ–ç‰‡-->
    <meta property="og:image" content="g6-u14.png">
    <meta property="og:image:width" content="1024">
    <meta property="og:image:height" content="1536">
    <meta property="og:image:alt" content="Jessie Math éŠæˆ²å°é¢">

    <!-- âœ… æœ‰äº›å¹³å°æœƒåƒè€ƒ -->
    <link rel="image_src" href="g6-u14.png">

    <!-- âœ… Twitter / Xï¼ˆå¯ç”¨åŒä¸€å¼µåœ–ï¼‰ -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Jessie Math  - è§’æŸ±èˆ‡åœ“æŸ±">
    <meta name="twitter:description" content="Â© 2025â€“2026 Jessie Math æ·æè€å¸«. All rights reserved.">
    <meta name="twitter:image" content="g6-u14.png">

    <!-- âœ… footer æœƒç”¨åˆ° icon -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"/>

    <style>
        :root {
            --primary-color: #4A90E2;
            --accent-color: #FFD700;
            --text-dark: #333;
            --bg-light: #F9F9F9;
        }

        body { font-family: "Microsoft JhengHei", sans-serif; margin: 0; background-color: var(--bg-light); }

        /* --- Hero å€ --- */
        .hero-nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 40px;
            background: #fff;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            gap: 16px;
        }

        .brand-box { display: flex; align-items: center; min-width: 220px; }
        .brand-logo {
            width: 60px; height: 60px;
            border: 4px solid var(--accent-color);
            border-radius: 50%;
            margin-right: 15px;
            background-image: url('JESSIEMATH-Q.png');
            background-size: cover;
            background-color: transparent;
            flex: 0 0 auto;
        }
        .brand-name { font-size: 28px; font-weight: bold; color: #35495e; white-space: nowrap; }

        .nav-buttons { display: flex; gap: 10px; flex-wrap: wrap; justify-content: flex-end; }
        .nav-btn {
            text-decoration: none;
            padding: 10px 18px;
            border-radius: 25px;
            border: 1px solid #ddd;
            color: var(--text-dark);
            font-weight: bold;
            display: flex;
            align-items: center;
            transition: 0.3s;
            white-space: nowrap;
        }
        .nav-btn:hover { background-color: #f0f0f0; }
        .nav-btn.active { background-color: #E8F0FE; color: var(--primary-color); border-color: var(--primary-color); }

        /* --- éŠæˆ²ä¸»é«”å®¹å™¨ --- */
        #game-container { max-width: 900px; margin: 40px auto; padding: 20px; text-align: center; }
        .page { display: none; background: white; padding: 40px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        .active-page { display: block; }

        /* --- UI å…ƒä»¶ --- */
        input[type="text"] { padding: 12px; font-size: 18px; border-radius: 8px; border: 2px solid #ddd; width: 60%; margin-bottom: 20px; }
        .btn-start { padding: 15px 40px; font-size: 20px; background: #FF9800; color: white; border: none; border-radius: 10px; cursor: pointer; }

        .level-card {
            padding: 20px; margin: 15px; background: #f8f9fa; border-radius: 15px;
            cursor: pointer; transition: transform 0.2s; border: 2px solid transparent;
            text-align: left;
        }
        .level-card:hover { transform: translateY(-5px); border-color: var(--primary-color); }

        /* âœ… æ¨¡å¼æŒ‰éˆ•ï¼ˆé¸é—œå¡æ–°å¢ï¼‰ */
        .mode-row{
            display:flex; gap:10px; flex-wrap:wrap;
            margin-top: 12px;
        }
        .mode-btn{
            padding: 10px 14px;
            border-radius: 999px;
            border: 1px solid rgba(0,0,0,.12);
            background: rgba(255,255,255,.9);
            cursor: pointer;
            font-weight: 800;
            color:#35495e;
            transition: .2s;
            user-select: none;
        }
        .mode-btn:hover{
            transform: translateY(-1px);
            border-color: rgba(74,144,226,.55);
            box-shadow: 0 10px 18px rgba(0,0,0,.08);
        }

        /* --- éŠæˆ²å…§æ•¸æ“šé¡¯ç¤º --- */
        .game-stats { display: flex; justify-content: space-around; font-size: 24px; font-weight: bold; margin-bottom: 20px; gap: 10px; flex-wrap: wrap; }
        .combo-text { color: #e91e63; font-style: italic; font-size: 30px; }

        .option-btn {
            padding: 15px; margin: 5px; font-size: 18px; background: #fff; border: 2px solid #4A90E2;
            border-radius: 10px; cursor: pointer; transition: 0.2s;
        }
        .option-btn:hover { background: #4A90E2; color: white; }

        .controls { margin-top: 30px; display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; }
        .btn-ctrl { padding: 10px 20px; border-radius: 5px; border: none; cursor: pointer; font-weight: bold; }

        /* --- æ’è¡Œæ¦œè¡¨æ ¼ --- */
        table { width: 100%; border-collapse: collapse; margin-top: 10px; }
        th, td { padding: 12px; border-bottom: 1px solid #eee; text-align: center; }
        th { background: #f4f4f4; }

        /* --- ä½œç­”å›é¥‹æ¢ --- */
        .feedback-bar{
            margin-top: 18px;
            padding: 14px 16px;
            border-radius: 12px;
            background: #f6f8ff;
            border: 1px solid rgba(74,144,226,0.22);
            display: none;
            text-align: left;
            font-size: 18px;
            line-height: 1.5;
        }
        .feedback-bar.show{ display:block; }
        .feedback-ok{ color:#2e7d32; font-weight: 800; }
        .feedback-bad{ color:#c62828; font-weight: 800; }
        .feedback-ans{ margin-top: 6px; color:#35495e; font-weight: 700; }
        .feedback-tip{ margin-top: 6px; color:#607d8b; font-size: 15px; }
        .disabled{ opacity: .55; pointer-events: none; }

        /* âœ… é¡Œç›®é™„åœ–ï¼ˆSVG / å°åœ–å¡ï¼‰ */
        .q-media{
            margin: 14px auto 6px;
            max-width: 520px;
            border-radius: 14px;
            overflow: hidden;
            border: 1px solid rgba(0,0,0,0.08);
            box-shadow: 0 10px 22px rgba(0,0,0,0.06);
            background: #fff;
            text-align: left;
        }
        .q-media .cap{
            padding: 10px 12px;
            font-size: 14px;
            color:#607d8b;
            background: #fafcff;
            border-top: 1px solid rgba(0,0,0,0.06);
        }
        .q-media svg{
            width:100%;
            height:auto;
            display:block;
            background: linear-gradient(180deg, rgba(248,250,252,.95), rgba(255,255,255,.96));
        }

        /* âœ… Footerï¼ˆä½ æŒ‡å®šçš„ footer-pillï¼Œä¸æ”¹å…§å®¹ï¼‰ */
        footer{
            margin-top: 34px;
            padding: 0 16px 22px;
        }
        .footer-pill{
            max-width: 980px;
            margin: 0 auto;
            display:flex;
            justify-content: space-between;
            align-items:center;
            gap: 14px;
            padding: 14px 16px;
            border-radius: 999px;
            background: rgba(255,255,255,0.92);
            border: 1px solid rgba(0,0,0,0.08);
            box-shadow: 0 10px 24px rgba(0,0,0,0.06);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            flex-wrap: wrap;
        }
        .footer-left, .footer-right{
            display:flex;
            align-items:center;
            gap: 10px;
            flex-wrap: wrap;
        }
        .footer-dot{
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: var(--accent-color);
            box-shadow: 0 0 0 6px rgba(255,215,0,0.18);
        }
        .footer-copy{
            color:#35495e;
            font-weight: 800;
            font-size: 14px;
        }
        .footer-icon{
            width: 34px;
            height: 34px;
            border-radius: 999px;
            display:flex;
            align-items:center;
            justify-content:center;
            background: rgba(74,144,226,0.10);
            border: 1px solid rgba(74,144,226,0.20);
            color:#35495e;
        }
        .footer-tagline{
            color:#607d8b;
            font-weight: 800;
            font-size: 14px;
            letter-spacing: .2px;
        }

        /* =========================
           âœ… RWDï¼šæ‰‹æ©Ÿ / å¹³æ¿ / é›»è…¦
           ========================= */
        @media (max-width: 980px){
            #game-container{ max-width: 920px; padding: 16px; margin: 26px auto; }
            .page{ padding: 26px; }
        }
        @media (max-width: 820px){
            .hero-nav{
                padding: 12px 16px;
                flex-wrap: wrap;
            }
            .brand-box{ min-width: 0; }
            .brand-logo{ width: 54px; height: 54px; margin-right: 12px; }
            .brand-name{ font-size: 24px; }
            input[type="text"]{ width: 100%; }

            /* é¸é—œå¡ä¸‰æ¬„ => å…©æ¬„ */
            #page-2 .level-grid{
                grid-template-columns: 1fr 1fr !important;
            }
        }
        @media (max-width: 520px){
            .brand-name{ font-size: 22px; }
            .nav-btn{ padding: 9px 14px; border-radius: 999px; }
            .page{ padding: 18px; border-radius: 16px; }
            .game-stats{ font-size: 18px; }
            .combo-text{ font-size: 22px; }
            /* é¸é …å…©æ¬„ => ä¸€æ¬„ */
            #options-container{ grid-template-columns: 1fr !important; }
            /* é¸é—œå¡å…©æ¬„ => ä¸€æ¬„ */
            #page-2 .level-grid{
                grid-template-columns: 1fr !important;
            }
            .level-card{ margin: 10px 0; }
        }
    </style>
</head>
<body>

    <nav class="hero-nav">
        <div class="brand-box">
            <div class="brand-logo"></div>
            <div class="brand-name">Jessie Math</div>
        </div>
        <div class="nav-buttons">
            <a href="https://jessiemath0703-chu.github.io/website2/" class="nav-btn">ğŸ  é¦–é </a>
            <a href="https://jessiemath0703-chu.github.io/Game-Lobby/" class="nav-btn">ğŸ® éŠæˆ²å¤§å»³</a>
            <a href="https://jessiemath0703-chu.github.io/Game-Lobby/#g6-u15" class="nav-btn active">ğŸ”™ å…­å¹´ç´šè§’æŸ±èˆ‡åœ“æŸ±</a>
        </div>
    </nav>

    <div id="game-container">

        <div id="page-1" class="page active-page">
            <h2>ğŸ  æ­¡è¿ä¾†åˆ°ç©ºé–“å¹¾ä½•æŒ‘æˆ°ï¼</h2>
            <p>è«‹è¼¸å…¥æ‚¨çš„åå­—ä»¥é–‹å§‹å†’éšªï¼š</p>
            <input type="text" id="player-name" placeholder="å°å¤©æ‰çš„åå­—...">
            <div style="text-align: left; background: #fffde7; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h4>ğŸ“œ éŠæˆ²è¦å‰‡ï¼š</h4>
                <ul>
                    <li>â³ <b>ç­”å°ï¼š</b> æ™‚é–“å¢åŠ  5 ç§’ã€‚</li>
                    <li>âš ï¸ <b>ç­”éŒ¯ï¼š</b> æ™‚é–“æ‰£é™¤ 5 ç§’ã€‚</li>
                    <li>ğŸ”¥ <b>Combo é€£æ“Šï¼š</b> é€£çºŒç­”å°å°‡ç²å¾—åˆ†æ•¸åŠ å€ç‡ï¼</li>
                    <li>ğŸ† <b>æ’è¡Œæ¦œï¼š</b> æŒ‘æˆ°å‰ååç²å–æ¦®è­½å¾½ç« ã€‚</li>
                </ul>
            </div>
            <button class="btn-start" onclick="goToPage(2)">é€²å…¥å†’éšª</button>
        </div>

        <div id="page-2" class="page">
            <h2 id="welcome-msg">é¸æ“‡é—œå¡</h2>

            <div class="level-grid" style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px;">
                <div class="level-card">
                    <h3>ç¬¬ä¸€é—œ</h3>
                    <p>è§’æŸ±èˆ‡åœ“æŸ±çš„é«”ç©</p>
                    <span>â­ é›£åº¦ï¼šç°¡å–®</span>
                    <div class="mode-row">
                        <button class="mode-btn basic" onclick="startGame(1,'basic')">åŸºç¤ï¼ˆå€’æ•¸ 120 ç§’ï¼‰</button>
                        <button class="mode-btn adv" onclick="startGame(1,'adv')">é€²éšï¼ˆå€’æ•¸ 90 ç§’ï¼‰</button>
                        <button class="mode-btn boss" onclick="startGame(1,'boss')">é­”ç‹ï¼ˆå€’æ•¸ 60 ç§’ï¼‰</button>
                    </div>
                </div>

                <div class="level-card">
                    <h3>ç¬¬äºŒé—œ</h3>
                    <p>è§’æŸ±èˆ‡åœ“æŸ±çš„æ‡‰ç”¨</p>
                    <span>â­â­ é›£åº¦ï¼šä¸­ç­‰</span>
                    <div class="mode-row">
                        <button class="mode-btn basic" onclick="startGame(2,'basic')">åŸºç¤ï¼ˆå€’æ•¸ 120 ç§’ï¼‰</button>
                        <button class="mode-btn adv" onclick="startGame(2,'adv')">é€²éšï¼ˆå€’æ•¸ 90 ç§’ï¼‰</button>
                        <button class="mode-btn boss" onclick="startGame(2,'boss')">é­”ç‹ï¼ˆå€’æ•¸ 60 ç§’ï¼‰</button>
                    </div>
                </div>

                <div class="level-card">
                    <h3>ç¬¬ä¸‰é—œ</h3>
                    <p>è§’æŸ±èˆ‡åœ“æŸ±çš„è¡¨é¢ç©</p>
                    <span>â­â­â­ é›£åº¦ï¼šæŒ‘æˆ°</span>
                    <div class="mode-row">
                        <button class="mode-btn basic" onclick="startGame(3,'basic')">åŸºç¤ï¼ˆå€’æ•¸ 120 ç§’ï¼‰</button>
                        <button class="mode-btn adv" onclick="startGame(3,'adv')">é€²éšï¼ˆå€’æ•¸ 90 ç§’ï¼‰</button>
                        <button class="mode-btn boss" onclick="startGame(3,'boss')">é­”ç‹ï¼ˆå€’æ•¸ 60 ç§’ï¼‰</button>
                    </div>
                </div>
            </div>

            <hr>
            <h3>ğŸ¥‡ æ¦®è­½æ’è¡Œæ¦œ (Top 10)</h3>
            <table id="leaderboard-table">
                <thead>
                    <!-- âœ… æ”¹ç‚ºï¼šç©å®¶å / é—œå¡ / æ¨¡å¼ / åˆ†æ•¸ -->
                    <tr><th>æ’å</th><th>ç©å®¶</th><th>é—œå¡</th><th>æ¨¡å¼</th><th>å¾—åˆ†</th></tr>
                </thead>
                <tbody id="leaderboard-body">
                </tbody>
            </table>
        </div>

        <div id="page-3" class="page">
            <div class="game-stats">
                <div>æ™‚é–“: <span id="timer">60</span>s</div>
                <div>åˆ†æ•¸: <span id="score">0</span></div>
                <div class="combo-text">Combo: <span id="combo">0</span> x</div>
            </div>

            <div id="question-box" style="min-height: 250px; background: #fff; padding: 20px; border-radius: 15px; border: 2px solid #eee;">
                <h3 id="q-text">é¡Œç›®è¼‰å…¥ä¸­...</h3>

                <div id="q-media" class="q-media" style="display:none;"></div>

                <div id="options-container" style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px;">
                </div>

                <div id="feedback" class="feedback-bar" aria-live="polite"></div>
            </div>

            <div class="controls">
                <button class="btn-ctrl" style="background:#607d8b; color:white;" onclick="togglePause()">â¸ï¸ æš«åœ/ç¹¼çºŒ</button>
                <button class="btn-ctrl" style="background:#f44336; color:white;" onclick="resetGame()">ğŸ”„ é‡æ–°é–‹å§‹</button>
                <button class="btn-ctrl" style="background:#9c27b0; color:white;" onclick="exitGame()">ğŸ° å›ä¸»é¸å–®</button>
            </div>
        </div>

    </div>

    <footer>
        <div class="footer-pill">
            <div class="footer-left">
                <div class="footer-dot" aria-hidden="true"></div>
                <div class="footer-copy">Â© 2025â€“2026 Jessie Math æ·æè€å¸«. All rights reserved.</div>
            </div>
            <div class="footer-right">
                <div class="footer-icon" aria-hidden="true"><i class="fas fa-compass"></i></div>
                <div class="footer-tagline">æ•¸å­¸ä¸è¿·è·¯ï¼ŒJessie å¸¶ä½ èµ°å‘ç†è§£ã€‚</div>
            </div>
        </div>
    </footer>

    <script>
        // --- è®Šæ•¸å®šç¾© ---
        let playerName = "";
        let score = 0;
        let timer = 60;
        let combo = 0;
        let gameActive = false;
        let timerInterval;
        let currentLevel = 1;
        let currentAnswer = "";
        let currentQuestionObj = null;

        // âœ… æ¨¡å¼ï¼ˆæ–°å¢ï¼‰
        let currentMode = "boss"; // basic / adv / boss
        const MODE_TIME = { basic: 120, adv: 90, boss: 60 };

        // âœ… é¡Œç›®æŠ½å–ç”¨ï¼šæ¯è¼ªå…ˆæ´—ç‰Œã€æŠ½å®Œå†æ´—ç‰Œï¼ˆä¸é‡è¤‡ç›´åˆ°æŠ½å®Œï¼‰
        const levelDecks = { 1: [], 2: [], 3: [] };
        const levelDeckIndex = { 1: 0, 2: 0, 3: 0 };

        // âœ… å¸¸æ•¸
        const PI = 3.14;

        function randInt(min, max){
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function shuffleArray(arr) {
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        function mcqNumber(correct, candidates){
            const set = new Set();
            set.add(String(correct));
            candidates.forEach(x => set.add(String(x)));
            const options = [...set].slice(0, 4);
            while(options.length < 4){
                const bump = randInt(-80, 120);
                options.push(String(Math.max(0, Number(correct) + bump)));
            }
            return shuffleArray(options.slice(0,4));
        }

        function mcqText(correct, distractors){
            const set = new Set([correct, ...distractors]);
            const options = [...set].slice(0,4);
            while(options.length < 4) options.push(distractors[randInt(0, distractors.length-1)]);
            return shuffleArray(options.slice(0,4));
        }

        function svgCylinder(labelTop, labelSide, labelH){
            return `
            <svg viewBox="0 0 520 240" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="cylinder">
              <defs>
                <linearGradient id="g" x1="0" y1="0" x2="1" y2="1">
                  <stop offset="0" stop-color="rgba(74,144,226,0.18)"/>
                  <stop offset="1" stop-color="rgba(74,144,226,0.06)"/>
                </linearGradient>
              </defs>
              <rect x="18" y="18" width="484" height="204" rx="18" fill="rgba(255,255,255,.75)" stroke="rgba(0,0,0,.08)"/>
              <g transform="translate(110,40)">
                <ellipse cx="150" cy="42" rx="92" ry="28" fill="url(#g)" stroke="rgba(53,73,94,.55)" stroke-width="2"/>
                <rect x="58" y="42" width="184" height="116" fill="url(#g)" stroke="rgba(53,73,94,.55)" stroke-width="2"/>
                <ellipse cx="150" cy="158" rx="92" ry="28" fill="rgba(74,144,226,0.10)" stroke="rgba(53,73,94,.55)" stroke-width="2"/>

                <text x="150" y="36" text-anchor="middle" font-size="18" fill="rgba(53,73,94,.9)" font-weight="700">${labelTop}</text>
                <text x="256" y="110" text-anchor="start" font-size="18" fill="rgba(53,73,94,.9)" font-weight="700">${labelSide}</text>

                <line x1="42" y1="42" x2="42" y2="158" stroke="rgba(0,0,0,.35)" stroke-width="2"/>
                <text x="24" y="104" text-anchor="middle" font-size="18" fill="rgba(53,73,94,.9)" font-weight="700">${labelH}</text>
              </g>
            </svg>`;
        }

        function svgPrism(labelBase, labelH){
            return `
            <svg viewBox="0 0 520 240" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="prism">
              <defs>
                <linearGradient id="p" x1="0" y1="0" x2="1" y2="1">
                  <stop offset="0" stop-color="rgba(255,215,0,0.22)"/>
                  <stop offset="1" stop-color="rgba(74,144,226,0.10)"/>
                </linearGradient>
              </defs>
              <rect x="18" y="18" width="484" height="204" rx="18" fill="rgba(255,255,255,.75)" stroke="rgba(0,0,0,.08)"/>
              <g transform="translate(110,40)">
                <polygon points="60,60 190,30 320,60 190,90" fill="rgba(74,144,226,0.10)" stroke="rgba(53,73,94,.55)" stroke-width="2"/>
                <polygon points="60,60 60,160 190,190 190,90" fill="url(#p)" stroke="rgba(53,73,94,.55)" stroke-width="2"/>
                <polygon points="190,90 190,190 320,160 320,60" fill="rgba(255,215,0,0.10)" stroke="rgba(53,73,94,.55)" stroke-width="2"/>
                <polygon points="60,160 190,190 320,160 190,130" fill="rgba(74,144,226,0.08)" stroke="rgba(53,73,94,.55)" stroke-width="2"/>

                <text x="190" y="24" text-anchor="middle" font-size="18" fill="rgba(53,73,94,.9)" font-weight="800">${labelBase}</text>
                <line x1="44" y1="66" x2="44" y2="162" stroke="rgba(0,0,0,.35)" stroke-width="2"/>
                <text x="26" y="118" text-anchor="middle" font-size="18" fill="rgba(53,73,94,.9)" font-weight="800">${labelH}</text>
              </g>
            </svg>`;
        }

        function renderQuestionMedia(qData){
            const box = document.getElementById('q-media');
            if(qData && qData.svg){
                const cap = qData.cap ? `<div class="cap">${qData.cap}</div>` : `<div class="cap">çœ‹åœ–è§£é¡Œï¼šæŠŠåœ–ä¸Šçš„æ¨™ç¤ºç”¨åœ¨å…¬å¼è£¡ âœ¨</div>`;
                box.innerHTML = qData.svg + cap;
                box.style.display = "block";
            }else{
                box.innerHTML = "";
                box.style.display = "none";
            }
        }

        const baseQuestions = { /*ï¼ˆä¿æŒä½ åŸæœ¬å…§å®¹ï¼Œä¸æ”¹ä¸å‹•ï¼‰*/
            1: [
                { q: "åº•é¢ç© 50 å¹³æ–¹å…¬åˆ†ï¼Œé«˜ 10 å…¬åˆ†çš„è§’æŸ±ï¼Œé«”ç©æ˜¯å¤šå°‘ç«‹æ–¹å…¬åˆ†ï¼Ÿ", options: ["500", "50", "150", "250"], a: "500" },
                { q: "åŠå¾‘ 5 å…¬åˆ†ï¼Œé«˜ 10 å…¬åˆ†çš„åœ“æŸ±ï¼Œé«”ç©ç´„ç‚ºå¤šå°‘ç«‹æ–¹å…¬åˆ†ï¼Ÿ(Ï€=3.14)", options: ["785", "1570", "314", "157"], a: "785" },
                { q: "åº•é¢ç‚º 8Ã—8 æ­£æ–¹å½¢ï¼Œé«˜ç‚º 14 å…¬åˆ†çš„å››è§’æŸ±ï¼Œé«”ç©ç‚ºä½•ï¼Ÿ", options: ["896", "448", "112", "64"], a: "896" },
                { q: "åº•é¢ç© 48 å¹³æ–¹å…¬åˆ†ï¼ŒæŸ±é«˜ 25 å…¬åˆ†çš„è§’æŸ±ï¼Œé«”ç©æ˜¯å¤šå°‘ç«‹æ–¹å…¬åˆ†ï¼Ÿ", options: ["1200", "960", "2400", "1920"], a: "1200" },
                { q: "åœ“æŸ±åº•é¢åŠå¾‘ 3 å…¬åˆ†ï¼Œé«˜ 15 å…¬åˆ†ï¼Œé«”ç©ç´„å¤šå°‘ç«‹æ–¹å…¬åˆ†ï¼Ÿ(Ï€=3.14)", options: ["424", "283", "141", "565"], a: "424" },
                { q: "åœ“æŸ±åº•é¢ç›´å¾‘ 10 å…¬åˆ†ï¼Œé«˜ 16 å…¬åˆ†ï¼Œé«”ç©ç´„å¤šå°‘ç«‹æ–¹å…¬åˆ†ï¼Ÿ(Ï€=3.14)", options: ["1256", "502.4", "1570", "628"], a: "1256" },
                (function(){
                    const d = randInt(8, 16);
                    const h = randInt(10, 22);
                    const r = d/2;
                    const v = Math.round((PI * r * r * h) * 10) / 10;
                    const opts = mcqNumber(v, [Math.round(v*0.8), Math.round(v*1.2), Math.round(v/2)]);
                    return {
                        q: `çœ‹åœ–ï¼šåœ“æŸ±çš„ç›´å¾‘ç‚º ${d} å…¬åˆ†ï¼Œé«˜ç‚º ${h} å…¬åˆ†ã€‚é«”ç©ç´„å¤šå°‘ç«‹æ–¹å…¬åˆ†ï¼Ÿ(Ï€=3.14)`,
                        options: opts,
                        a: String(v),
                        svg: svgCylinder(`ç›´å¾‘ ${d}`, "åœ“æŸ±", `é«˜ ${h}`),
                        cap: "æç¤ºï¼šå…ˆæŠŠç›´å¾‘è®ŠåŠå¾‘ï¼Œå†ç®— Ï€rÂ²hã€‚"
                    };
                })(),
                (function(){
                    const baseA = randInt(36, 90);
                    const h = randInt(8, 18);
                    const v = baseA * h;
                    const opts = mcqNumber(v, [v+baseA, v-h, v+2*h]);
                    return {
                        q: `çœ‹åœ–ï¼šè§’æŸ±çš„åº•é¢ç©ç‚º ${baseA} å¹³æ–¹å…¬åˆ†ï¼ŒæŸ±é«˜ç‚º ${h} å…¬åˆ†ã€‚é«”ç©æ˜¯å¤šå°‘ç«‹æ–¹å…¬åˆ†ï¼Ÿ`,
                        options: opts,
                        a: String(v),
                        svg: svgPrism(`åº•é¢ç© ${baseA}`, `é«˜ ${h}`),
                        cap: "æç¤ºï¼šé«”ç©ï¼åº•é¢ç©Ã—æŸ±é«˜ã€‚"
                    };
                })(),
                { q: "å…©å€‹è§’æŸ±åº•é¢ç©ç›¸åŒï¼Œç”²æŸ±é«˜ 10 å…¬åˆ†ï¼Œä¹™æŸ±é«˜ 15 å…¬åˆ†ã€‚ä¹™çš„é«”ç©æ˜¯ç”²çš„å¹¾å€ï¼Ÿ", options: ["1.5 å€", "1.2 å€", "2 å€", "0.5 å€"], a: "1.5 å€" },
                { q: "å…©å€‹æŸ±é«”æŸ±é«˜ç›¸åŒï¼Œç”²åº•é¢ç© 52ï¼Œä¹™åº•é¢ç© 48ï¼ˆå¹³æ–¹å…¬åˆ†ï¼‰ã€‚å“ªä¸€å€‹é«”ç©è¼ƒå¤§ï¼Ÿ", options: ["ç”²", "ä¹™", "ä¸€æ¨£å¤§", "ç„¡æ³•åˆ¤æ–·"], a: "ç”²" }
            ],
            2: [
                { q: "å¤§ç½é ­ç›´å¾‘ 20 å…¬åˆ†ï¼Œé«˜ 18 å…¬åˆ†ï¼Œé«”ç©ç´„æ˜¯å¤šå°‘ç«‹æ–¹å…¬åˆ†ï¼Ÿ(Ï€=3.14)", options: ["5652", "1130.4", "2260.8", "2826"], a: "5652" },
                { q: "è¦è²¼ä¸€åœˆåŒ…è£ç´™åœ¨ç›´å¾‘ 10ã€é«˜ 20 çš„ç½é ­å´é¢ï¼Œå´é¢ç©ç´„å¤šå°‘å¹³æ–¹å…¬åˆ†ï¼Ÿ(Ï€=3.14)", options: ["628", "314", "1570", "1256"], a: "628" },
                { q: "ç©ºå¿ƒæŸ±é«”å¤–ç›´å¾‘ 10ã€å…§ç›´å¾‘ 6ã€é«˜ 15ï¼Œææ–™é«”ç©ç´„å¤šå°‘ç«‹æ–¹å…¬åˆ†ï¼Ÿ(Ï€=3.14)", options: ["753.6", "1177.5", "376.8", "1507.2"], a: "753.6" },
                (function(){
                    const d = randInt(8, 18);
                    const h = randInt(10, 26);
                    const area = Math.round((PI * d * h) * 10) / 10;
                    const opts = mcqNumber(area, [Math.round(area*0.9), Math.round(area*1.1), Math.round(area/2)]);
                    return {
                        q: `çœ‹åœ–ï¼šåœ“æŸ±çš„ç›´å¾‘ç‚º ${d} å…¬åˆ†ï¼Œé«˜ç‚º ${h} å…¬åˆ†ã€‚å´é¢ç©ç´„å¤šå°‘å¹³æ–¹å…¬åˆ†ï¼Ÿ(Ï€=3.14)`,
                        options: opts,
                        a: String(area),
                        svg: svgCylinder(`ç›´å¾‘ ${d}`, "å´é¢åŒ…è£ç´™", `é«˜ ${h}`),
                        cap: "æç¤ºï¼šå´é¢ç©ï¼åœ“å‘¨Ã—é«˜ï¼(Ï€d)Ã—hã€‚"
                    };
                })(),
                { q: "ä¸€å€‹è§’æŸ±åº•é¢å‘¨é•· 30 å…¬åˆ†ï¼Œé«˜ 10 å…¬åˆ†ã€‚è‹¥è¦åŒ…ã€å´é¢ã€ä¸€åœˆï¼Œå´é¢ç©æ˜¯å¤šå°‘å¹³æ–¹å…¬åˆ†ï¼Ÿ", options: ["300", "600", "150", "400"], a: "300" },
                { q: "å…©å€‹åœ“æŸ±æŸ±é«˜ç›¸åŒï¼šç”²åŠå¾‘ 4ï¼Œä¹™åŠå¾‘ 6ï¼ˆå…¬åˆ†ï¼‰ã€‚ä¹™çš„é«”ç©æ˜¯ç”²çš„å¹¾å€ï¼Ÿ", options: ["2.25 å€", "1.5 å€", "3 å€", "4 å€"], a: "2.25 å€" }
            ],
            3: [
                { q: "é‚Šé•· 10 å…¬åˆ†çš„æ­£æ–¹é«”ï¼Œè¡¨é¢ç©æ˜¯å¤šå°‘å¹³æ–¹å…¬åˆ†ï¼Ÿ", options: ["600", "100", "1000", "400"], a: "600" },
                { q: "åº•é¢å‘¨é•· 30ã€å…¬é«˜ 10ã€åº•é¢ç© 50 çš„è§’æŸ±ï¼Œè¡¨é¢ç©ç‚ºä½•ï¼Ÿ", options: ["400", "350", "130", "500"], a: "400" },
                { q: "åœ“æŸ±åŠå¾‘ 10ã€é«˜ 20ï¼Œè¡¨é¢ç©å¤§ç´„æ˜¯å¤šå°‘å¹³æ–¹å…¬åˆ†ï¼Ÿ(Ï€=3.14)", options: ["1884", "1256", "628", "1570"], a: "1884" },
                { q: "åœ“æŸ±ç›´å¾‘ 10ã€å…¬é«˜ 20ï¼Œå´é¢ç©ç´„å¤šå°‘å¹³æ–¹å…¬åˆ†ï¼Ÿ(Ï€=3.14)", options: ["628", "314", "1570", "1256"], a: "628" },
                (function(){
                    const d = randInt(8, 18);
                    const h = randInt(10, 22);
                    const r = d/2;
                    const sa = Math.round((2*PI*r*(r+h)) * 10) / 10;
                    const opts = mcqNumber(sa, [Math.round(sa*0.85), Math.round(sa*1.15), Math.round(sa-PI*r*r)]);
                    return {
                        q: `çœ‹åœ–ï¼šåœ“æŸ±ç›´å¾‘ ${d} å…¬åˆ†ï¼Œé«˜ ${h} å…¬åˆ†ã€‚è¡¨é¢ç©ç´„å¤šå°‘å¹³æ–¹å…¬åˆ†ï¼Ÿ(Ï€=3.14)`,
                        options: opts,
                        a: String(sa),
                        svg: svgCylinder(`ç›´å¾‘ ${d}`, "è¡¨é¢ç©", `é«˜ ${h}`),
                        cap: "æç¤ºï¼šè¡¨é¢ç©ï¼å´é¢ç©ï¼‹å…©å€‹åº•é¢ç©ã€‚"
                    };
                })(),
                { q: "è§’æŸ±åº•é¢å‘¨é•· 52 å…¬åˆ†ï¼Œé«˜ 25 å…¬åˆ†ï¼Œå´é¢ç©æ˜¯å¤šå°‘å¹³æ–¹å…¬åˆ†ï¼Ÿ", options: ["1300", "1040", "2600", "650"], a: "1300" },
                { q: "ä¸€å€‹è§’æŸ±å´é¢ç© 300ï¼Œåº•é¢ç© 80ï¼ˆå¹³æ–¹å…¬åˆ†ï¼‰ã€‚è¡¨é¢ç©æ˜¯å¤šå°‘å¹³æ–¹å…¬åˆ†ï¼Ÿ", options: ["460", "380", "540", "700"], a: "460" }
            ]
        };

        function generateQuestions(level){
            const qs = [];

            if(level === 1){
                for(let i=0;i<6;i++){
                    const useD = Math.random() < 0.5;
                    const r = randInt(2, 8);
                    const d = r*2;
                    const h = randInt(8, 24);
                    const v = Math.round((PI * r * r * h) * 10) / 10;
                    const opts = mcqNumber(v, [Math.round(v*0.75), Math.round(v*1.25), Math.round(v + PI*r*r)]);
                    const useSvg = Math.random() < 0.7;
                    qs.push({
                        q: useD
                            ? `åœ“æŸ±åº•é¢ç›´å¾‘ ${d} å…¬åˆ†ï¼Œé«˜ ${h} å…¬åˆ†ï¼Œé«”ç©ç´„å¤šå°‘ç«‹æ–¹å…¬åˆ†ï¼Ÿ(Ï€=3.14)`
                            : `åœ“æŸ±åº•é¢åŠå¾‘ ${r} å…¬åˆ†ï¼Œé«˜ ${h} å…¬åˆ†ï¼Œé«”ç©ç´„å¤šå°‘ç«‹æ–¹å…¬åˆ†ï¼Ÿ(Ï€=3.14)`,
                        options: opts,
                        a: String(v),
                        ...(useSvg ? {
                            svg: svgCylinder(useD ? `ç›´å¾‘ ${d}` : `åŠå¾‘ ${r}`, "é«”ç©", `é«˜ ${h}`),
                            cap: "æç¤ºï¼šé«”ç©ï¼Ï€rÂ²hã€‚"
                        } : {})
                    });
                }

                for(let i=0;i<5;i++){
                    const baseA = randInt(24, 120);
                    const h = randInt(6, 20);
                    const v = baseA * h;
                    const opts = mcqNumber(v, [v+baseA, v-baseA, v+h*10]);
                    const useSvg = Math.random() < 0.7;
                    qs.push({
                        q: `è§’æŸ±åº•é¢ç© ${baseA} å¹³æ–¹å…¬åˆ†ï¼ŒæŸ±é«˜ ${h} å…¬åˆ†ï¼Œé«”ç©æ˜¯å¤šå°‘ç«‹æ–¹å…¬åˆ†ï¼Ÿ`,
                        options: opts,
                        a: String(v),
                        ...(useSvg ? {
                            svg: svgPrism(`åº•é¢ç© ${baseA}`, `é«˜ ${h}`),
                            cap: "æç¤ºï¼šé«”ç©ï¼åº•é¢ç©Ã—æŸ±é«˜ã€‚"
                        } : {})
                    });
                }

                for(let i=0;i<3;i++){
                    const baseA = randInt(30, 90);
                    const h = randInt(8, 18);
                    const v = baseA * h;
                    const opts = mcqNumber(h, [h+2, h-2, h+5].map(x=>Math.max(1,x)));
                    qs.push({
                        q: `ä¸€å€‹è§’æŸ±é«”ç© ${v} ç«‹æ–¹å…¬åˆ†ï¼Œåº•é¢ç© ${baseA} å¹³æ–¹å…¬åˆ†ï¼ŒæŸ±é«˜æ˜¯å¤šå°‘å…¬åˆ†ï¼Ÿ`,
                        options: opts,
                        a: String(h)
                    });
                }
            }

            if(level === 2){
                for(let i=0;i<6;i++){
                    const d = randInt(8, 20);
                    const h = randInt(10, 26);
                    const area = Math.round((PI * d * h) * 10) / 10;
                    const opts = mcqNumber(area, [Math.round(area*0.9), Math.round(area*1.1), Math.round(area/2)]);
                    const useSvg = Math.random() < 0.7;
                    qs.push({
                        q: `ç½é ­ç›´å¾‘ ${d} å…¬åˆ†ï¼Œé«˜ ${h} å…¬åˆ†ã€‚è²¼å´é¢åŒ…è£ç´™éœ€è¦çš„é¢ç©ç´„å¤šå°‘å¹³æ–¹å…¬åˆ†ï¼Ÿ(Ï€=3.14)`,
                        options: opts,
                        a: String(area),
                        ...(useSvg ? {
                            svg: svgCylinder(`ç›´å¾‘ ${d}`, "å´é¢ç©", `é«˜ ${h}`),
                            cap: "æç¤ºï¼šå´é¢ç©ï¼(Ï€d)Ã—hã€‚"
                        } : {})
                    });
                }

                for(let i=0;i<3;i++){
                    const r1 = randInt(2, 6);
                    const r2 = randInt(r1+1, 8);
                    const ratio = (r2*r2)/(r1*r1);
                    const ratioText = (Math.round(ratio*100)/100).toString().replace(/\.0+$/,'');
                    qs.push({
                        q: `å…©å€‹åœ“æŸ±æŸ±é«˜ç›¸åŒï¼šç”²åŠå¾‘ ${r1} å…¬åˆ†ã€ä¹™åŠå¾‘ ${r2} å…¬åˆ†ã€‚ä¹™çš„é«”ç©æ˜¯ç”²çš„å¹¾å€ï¼Ÿ`,
                        options: mcqText(`${ratioText} å€`, ["1.5 å€", "2 å€", "3 å€", "4 å€", "2.25 å€"]),
                        a: `${ratioText} å€`
                    });
                }

                for(let i=0;i<4;i++){
                    const per = randInt(24, 60);
                    const h = randInt(8, 22);
                    const area = per*h;
                    const opts = mcqNumber(area, [area+per, area+h*10, area-per]);
                    qs.push({
                        q: `è§’æŸ±åº•é¢å‘¨é•· ${per} å…¬åˆ†ï¼Œé«˜ ${h} å…¬åˆ†ã€‚å´é¢ç©æ˜¯å¤šå°‘å¹³æ–¹å…¬åˆ†ï¼Ÿ`,
                        options: opts,
                        a: String(area)
                    });
                }
            }

            if(level === 3){
                for(let i=0;i<6;i++){
                    const r = randInt(2, 8);
                    const h = randInt(8, 24);
                    const sa = Math.round((2*PI*r*(r+h))*10)/10;
                    const opts = mcqNumber(sa, [Math.round(sa*0.85), Math.round(sa*1.15), Math.round(sa-PI*r*r)]);
                    const useSvg = Math.random() < 0.7;
                    qs.push({
                        q: `åœ“æŸ±åŠå¾‘ ${r} å…¬åˆ†ï¼Œé«˜ ${h} å…¬åˆ†ã€‚è¡¨é¢ç©ç´„å¤šå°‘å¹³æ–¹å…¬åˆ†ï¼Ÿ(Ï€=3.14)`,
                        options: opts,
                        a: String(sa),
                        ...(useSvg ? {
                            svg: svgCylinder(`åŠå¾‘ ${r}`, "è¡¨é¢ç©", `é«˜ ${h}`),
                            cap: "æç¤ºï¼šè¡¨é¢ç©ï¼2Ï€r(r+h)ã€‚"
                        } : {})
                    });
                }

                for(let i=0;i<6;i++){
                    const per = randInt(24, 60);
                    const h = randInt(8, 22);
                    const baseA = randInt(30, 120);
                    const lateral = per*h;
                    const sa = lateral + 2*baseA;
                    const opts = mcqNumber(sa, [sa+baseA, sa-lateral, sa+per]);
                    qs.push({
                        q: `è§’æŸ±åº•é¢å‘¨é•· ${per} å…¬åˆ†ï¼Œé«˜ ${h} å…¬åˆ†ï¼Œåº•é¢ç© ${baseA} å¹³æ–¹å…¬åˆ†ã€‚è¡¨é¢ç©æ˜¯å¤šå°‘å¹³æ–¹å…¬åˆ†ï¼Ÿ`,
                        options: opts,
                        a: String(sa)
                    });
                }
            }

            return qs;
        }

        function buildLevelQuestions(level){
            const fixed = baseQuestions[level] ? [...baseQuestions[level]] : [];
            const gen = generateQuestions(level);
            return fixed.concat(gen);
        }

        function resetDeck(level) {
            levelDecks[level] = shuffleArray(buildLevelQuestions(level));
            levelDeckIndex[level] = 0;
        }

        function drawQuestion(level) {
            if (!levelDecks[level] || levelDecks[level].length === 0) resetDeck(level);
            if (levelDeckIndex[level] >= levelDecks[level].length) {
                resetDeck(level);
            }
            const q = levelDecks[level][levelDeckIndex[level]];
            levelDeckIndex[level] += 1;
            return q;
        }

        function goToPage(pageNumber) {
            if (pageNumber === 2) {
                const nameInput = document.getElementById('player-name').value;
                if (!nameInput) { alert("è«‹è¼¸å…¥åå­—ä»¥è¨˜éŒ„æˆç¸¾ï¼"); return; }
                playerName = nameInput;
                document.getElementById('welcome-msg').innerText = `ä½ å¥½ï¼Œ${playerName}ï¼`;
                renderLeaderboard();
            }
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active-page'));
            document.getElementById(`page-${pageNumber}`).classList.add('active-page');
        }

        function startGame(level, mode) {
            currentLevel = level;
            currentMode = mode || "boss";
            score = 0;
            timer = MODE_TIME[currentMode] ?? 60;
            combo = 0;
            gameActive = true;

            resetDeck(currentLevel);

            goToPage(3);
            updateStats();
            nextQuestion();

            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                if (gameActive) {
                    timer--;
                    updateStats();
                    if (timer <= 0) endGame();
                }
            }, 1000);
        }

        function nextQuestion() {
            hideFeedback();

            const qData = drawQuestion(currentLevel);
            currentQuestionObj = qData;

            document.getElementById('q-text').innerText = qData.q;
            currentAnswer = qData.a;

            renderQuestionMedia(qData);

            const shuffledOptions = shuffleArray([...qData.options]);

            const container = document.getElementById('options-container');
            container.innerHTML = "";
            shuffledOptions.forEach(opt => {
                const btn = document.createElement('button');
                btn.className = "option-btn";
                btn.innerText = opt;
                btn.onclick = () => checkAnswer(opt);
                container.appendChild(btn);
            });
        }

        function setOptionsDisabled(disabled) {
            const container = document.getElementById('options-container');
            [...container.querySelectorAll('button')].forEach(b => {
                if (disabled) b.classList.add('disabled');
                else b.classList.remove('disabled');
                b.disabled = disabled;
            });
        }

        function showFeedback(isCorrect, correctAnswer) {
            const fb = document.getElementById('feedback');
            const msg = isCorrect
                ? `<div class="feedback-ok">âœ… ç­”å°äº†ï¼æ™‚é–“ +5 ç§’ï¼ŒCombo +1</div>`
                : `<div class="feedback-bad">âŒ ç­”éŒ¯äº†ï¼æ™‚é–“ -5 ç§’ï¼ŒCombo æ­¸é›¶</div>
                   <div class="feedback-ans">æ­£ç¢ºç­”æ¡ˆï¼š${correctAnswer}</div>`;
            fb.innerHTML = msg + `<div class="feedback-tip">ä¸‹ä¸€é¡Œå³å°‡å‚³é€â€¦ğŸš€</div>`;
            fb.classList.add('show');
        }

        function hideFeedback() {
            const fb = document.getElementById('feedback');
            fb.classList.remove('show');
            fb.innerHTML = "";
        }

        function checkAnswer(selected) {
            if (!gameActive) return;

            setOptionsDisabled(true);

            if (selected === currentAnswer) {
                combo++;
                timer += 5;
                score += (100 * (combo > 1 ? (1 + combo * 0.1) : 1));
                showFeedback(true, currentAnswer);
            } else {
                combo = 0;
                timer -= 5;
                showFeedback(false, currentAnswer);
            }

            updateStats();

            setTimeout(() => {
                if (!gameActive) return;
                setOptionsDisabled(false);
                nextQuestion();
            }, 900);
        }

        function updateStats() {
            document.getElementById('score').innerText = Math.floor(score);
            document.getElementById('timer').innerText = timer;
            document.getElementById('combo').innerText = combo;
        }

        function togglePause() { gameActive = !gameActive; }

        function endGame() {
            gameActive = false;
            clearInterval(timerInterval);
            alert(`éŠæˆ²çµæŸï¼æ‚¨çš„æœ€çµ‚åˆ†æ•¸æ˜¯ï¼š${Math.floor(score)}`);

            // âœ… å­˜æª”ï¼šåŠ å…¥ level + mode
            saveScore(playerName, Math.floor(score), currentLevel, currentMode);

            goToPage(2);
        }

        function exitGame() {
            if(confirm("è¦é›¢é–‹ç›®å‰çš„éŠæˆ²å—ï¼Ÿåˆ†æ•¸å°‡ä¸è¢«è¨˜éŒ„ã€‚")) {
                clearInterval(timerInterval);
                goToPage(2);
            }
        }

        function resetGame() {
            if(confirm("ç¢ºå®šè¦é‡æ–°é–‹å§‹å—ï¼Ÿ")) startGame(currentLevel, currentMode);
        }

        // --- æ’è¡Œæ¦œé‚è¼¯ (localStorage) ---
        // âœ… è®Šæ›´ï¼šsaveScore å¤šå­˜ level + mode
        function saveScore(name, finalScore, level, mode) {
            let history = JSON.parse(localStorage.getItem('jessieMath_scores')) || [];
            history.push({
                name: name,
                score: finalScore,
                level: level || 1,
                mode: mode || "boss",
                date: new Date().toLocaleDateString()
            });

            history.sort((a, b) => b.score - a.score);
            history = history.slice(0, 10);
            localStorage.setItem('jessieMath_scores', JSON.stringify(history));
            renderLeaderboard();
        }

        // âœ… é¡¯ç¤ºï¼šç©å®¶ / é—œå¡ / æ¨¡å¼ / åˆ†æ•¸ï¼ˆä¸¦å…¼å®¹èˆŠè³‡æ–™ï¼‰
        function renderLeaderboard() {
            const history = JSON.parse(localStorage.getItem('jessieMath_scores')) || [];
            const tbody = document.getElementById('leaderboard-body');
            tbody.innerHTML = "";

            if (history.length === 0) {
                tbody.innerHTML = "<tr><td colspan='5'>ç›®å‰å°šç„¡ç´€éŒ„ï¼Œå¿«ä¾†æŒ‘æˆ°å§ï¼</td></tr>";
                return;
            }

            const modeLabel = (m) => (m === "basic" ? "åŸºç¤" : (m === "adv" ? "é€²éš" : "é­”ç‹"));
            const levelLabel = (lv) => `ç¬¬${lv}é—œ`;

            history.forEach((record, index) => {
                let medal = index === 0 ? "ğŸ¥‡" : (index === 1 ? "ğŸ¥ˆ" : (index === 2 ? "ğŸ¥‰" : index + 1));
                const mode = modeLabel(record.mode || "boss");
                const level = levelLabel(record.level || 1);
                tbody.innerHTML += `<tr><td>${medal}</td><td>${record.name}</td><td>${level}</td><td>${mode}</td><td>${record.score}</td></tr>`;
            });
        }
    </script>
</body>
</html>
